---
openapi: 3.0.0
info:
  title: service-workbench-on-aws
  description: API collection of service-workbench-on-aws
  contact:
    email: aws-chamonix-dev@amazon.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: v1.4.3
tags:
- name: admins
  description: Secured Admin-only calls
- name: researchers
  description: Operations available to regular researchers
- name: BYOB
  description: Operations for bring your own bucket configuration
- name: SC-EnvType
  description: Operations for service catalog environment types
- name: SC-EnvTypeConfig
  description: Operations for service catalog environment type configurations
- name: SC-EnvWorkspace
  description: Operations for create and manage workspaces with service catalog environment types
- name: Studies
  description: Operations for create and manage studies (Data folders)
- name: Budgets
  description: Operations for create and manage budgets
paths:
  /api/data-sources/accounts:
    get:
      tags:
      - admins
      - BYOB
      summary: List DS Acccounts
      operationId: ListDSAcccounts
      description: |
        List all external DataSource accounts
      responses:
        '200':
          description: Array of data source accounts
    post:
      tags:
      - admins
      - BYOB
      summary: Register DS account
      description: Add a data source account
      operationId: RegisterDSaccount
      requestBody:
        description: Data source AWS account to add
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDataSourceAccount'
      responses:
        "201":
          description: item created
  /api/data-sources/accounts/{awsAccountId}:
    put:
      tags:
      - admins
      - BYOB
      summary: Update DS account
      operationId: UpdateDSaccount
      parameters:
        - name: awsAccountId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/AwsAccountId'
      responses:
        '200':
          description: 'Update existing data source account'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateDataSourceAccount'
  /api/data-sources/accounts/{awsAccountId}/buckets:
    post:
      tags:
      - admins
      - BYOB
      summary: Register DS bucket
      operationId: RegisterDSbucket
      parameters:
        - name: awsAccountId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/AwsAccountId'
      responses:
        '201':
          description: 'bucket registered'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterDataSourceBucket'
  /api/data-sources/accounts/ops/reachability:
    post:
      tags:
      - admins
      - BYOB
      summary: Attempt to reach
      description: Attempt to test reachability/availability of registered accounts and their studies.
      operationId: AttemptReach
      responses:
        '200':
          description: reachability/availability of registered accounts and their studies requested
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataSourceReachability'
  /api/data-sources/accounts/{awsAccountId}/cfn:
    post:
      tags:
      - admins
      - BYOB
      summary: Generate Account CFN template
      operationId: GenerateAccountCFNtemplate
      description: Creates a CloudFormation template which will create an IAM role in Data Source Account which allows Service Workbench to create roles which will have access to S3 Study paths and KMS keys 
      parameters:
        - name: awsAccountId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/AwsAccountId'
      responses:
        '200':
          description: cfn template for data source account onboard
  /api/data-sources/accounts/{awsAccountId}/studies:
    get:
      tags:
      - admins
      - BYOB
      summary: List studies for account
      description: List all the studies under a data source account
      operationId: ListStudiesForAccount
      parameters:
        - name: awsAccountId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/AwsAccountId'
      responses:
        '200':
          description: array of studies under the data source account specified
  /api/data-sources/accounts/{awsAccountId}/buckets/{bucketName}/studies:
    post:
      tags:
      - admins
      - BYOB
      summary: Register Study
      operationId: RegisterStudy
      parameters:
        - name: awsAccountId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/AwsAccountId'
        - name: bucketName
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: array of studies under the bucket specified
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterStudy'
              
  /api/workspace-type-candidates:
    get:
      tags:
        - SC-EnvType
        - admins
      summary: list workspace type candidates
      operationId: listWSTypeCandidates
      parameters: 
        - in: query
          name: status
          schema:
            type: string
            enum:
              - '*'
              - 'not-imported'
        - name: version
          in: query
          schema: 
            type: string
            enum: 
              - '*'
              - 'latest'
      responses:
        '200':
          description: Array of workspace type candidates that fits the query filters. Default return latest not imported workspace type candidates.
  /api/workspace-types:
    get:
      tags: 
        - SC-EnvType
        - admins
      summary: list workspace types
      operationId: listWSTypes
      parameters: 
        - in: query
          name: status
          schema:
            type: string
            enum:
              - '*'
              - 'not-approved'
              - 'approved'
      responses:
        '200':
          description: Array of workspace types in the status queried. Default return approved. 
    post:
      tags:
        - SC-EnvType
        - admins
      summary: create (import) workspace type
      operationId: createWSType
      responses:
        '200':
          description: 'Return the workspace type imported.'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEnvType'
  /api/workspace-types/{envTypeId}:
    parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
    get: 
      tags:
        - admins
        - SC-EnvType
      summary: get environment type
      operationId: getEnvType
      responses:
        '200':
          description: 'return the environment type requested'
    delete:
      tags:
        - admins
        - SC-EnvType
      summary: delete (unimport) environment type
      operationId: deleteEnvType
      responses:
        '200':
          description: 'Return empty json object'
    put:
      tags:
        - admins
        - SC-EnvType
      summary: update environment type
      operationId: updateEnvType
      responses:
        '200':
          description: 'Return the updated envirnment type'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEnvType'
  /api/workspace-types/{envTypeId}/approve:
    put:
      tags:
        - admins
        - SC-EnvType
      summary: approve imported environment type
      operationId: approveEnvType
      responses:
        '200':
          description: 'Return the approved workspace type'
      parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                rev:
                  type: integer
                  description: revision number of the workspace type
  /api/workspace-types/{envTypeId}/revoke:
    put:
      summary: revoke
      operationId: revoke
      tags:
        - admins
        - SC-EnvType
      parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
      responses:
        '200':
          description: 'Return the revoked workspace type'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                rev:
                  type: integer
                  description: revision number of the workspace type
  /api/workspace-types/{envTypeId}/configurations/:
    parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
    get:
      summary: list environment configurations
      operationId: listEnvConfigs
      tags:
        - admins
        - SC-EnvTypeConfig
      parameters:
      - name: include
        in: query
        schema:
          type: string
          enum: 
            - all
      responses:
        '200':
          description: 'Return array of environment type configurations. Default return allowed to use only.'
    post:
      summary: create environment type configuration
      operationId: createEnvTypeConfig
      tags:
        - admins
        - SC-EnvTypeConfig
      responses:
        '200':
          description: 'Return the env type config created'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvTypeConfig'
  /api/workspace-types/{envTypeId}/configurations/{envTypeConfigId}:
    parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
      - name: envTypeConfigId
        in: path
        required: true
        schema:
          type: string
    get:
      summary: get a environment type configuration
      operationId: getEnvTypeConfig
      tags:
        - admins
        - SC-EnvTypeConfig
      responses:
        '200':
          description: 'Return the env type config requested'
    put:
      summary: update env type config
      operationId: updateEnvTypeConfig
      tags:
        - admins
        - SC-EnvTypeConfig
      responses:
        '200':
          description: 'Return the updated env type config'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EnvTypeConfig'
    delete:
      tags:
        - admins
        - SC-EnvTypeConfig
      summary: delete
      operationId: delete
      responses:
        '200':
          description: 'Return the config that was deleted'
  /api/workspace-types/{envTypeId}/config-vars/:
    get:
      summary: list config vars for env type config
      operationId: listConfigVars
      parameters:
      - name: envTypeId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/EnvTypeId'
      tags:
        - admins
        - SC-EnvTypeConfig
      responses:
        '200':
          description: 'Array of env type config variables'
  /api/workspaces/service-catalog:
    post:
      tags:
        - researchers
        - SC-EnvWorkspace
      summary: create environment using a configured SC product
      operationId: createSCEnv
      responses:
        '200':
          description: 'Return the workspace created'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSCWorkspace'
    get:
      tags:
        - researchers
        - SC-EnvWorkspace
      summary: list SC Workspaces
      operationId: listScWorkspaces
      responses:
        '200':
          description: 'Return list of Service Catalog workspaces'
  /api/workspaces/service-catalog/{workspaceId}:
    get:
      summary: get SC workspace
      operationId: getSCWorkspace
      parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/WorkspaceId'
      responses:
        '200':
          description: 'Return the service catalog workspace requested'
      tags:
        - researchers
        - SC-EnvWorkspace
    delete:
      summary: delete(terminate) SC workspace
      operationId: deleteSCWorkspace
      parameters:
      - name: workspaceId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/WorkspaceId'
      responses:
        '200':
          description: 'Return empty object'
      tags:
        - researchers
        - SC-EnvWorkspace
  /api/workspaces/service-catalog/{workspaceId}/stop:
    put:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
      summary: Stop a SC workspace
      operationId: stopScWs
      responses:
        '200':
          description: 'Return the workspace stopped'
  /api/workspaces/service-catalog/{workspaceId}/start:
    put:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
      summary: start SC workspace
      operationId: startScWs
      responses:
        '200':
          description: 'Return the workspace started'
  /api/workspaces/service-catalog/{workspaceId}/connections:
    get:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
      summary: list connections of a SC workspace
      operationId: listConnections
      responses:
        '200':
          description: 'Array of connections of the workspace'
  /api/workspaces/service-catalog/{workspaceId}/connections/{connectionId}/url:
    post:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
        - name: connectionId
          in: path
          required: true
          schema: 
            $ref: '#/components/schemas/ConnectionId'
      summary: Create connection URL
      operationId: createConnectionURL
      responses:
        '200':
          description: 'Return connection information with URL'
  /api/workspaces/service-catalog/{workspaceId}/connections/{connectionId}/windows-rdp-info:
    get:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
        - name: connectionId
          in: path
          required: true
          schema: 
            $ref: '#/components/schemas/ConnectionId'
      summary: get Windows password data for rdp
      operationId: getRdpInfo
      responses:
        '200':
          description: 'Return windows rdp info'
  /api/workspaces/service-catalog/{workspaceId}/connections/{connectionId}/send-ssh-public-key:
    post:
      tags:
        - researchers
        - SC-EnvWorkspace
      parameters:
        - name: workspaceId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/WorkspaceId'
        - name: connectionId
          in: path
          required: true
          schema: 
            $ref: '#/components/schemas/ConnectionId'
      summary: Send SSH public key
      operationId: sendPublicKey
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [keyPairId]
              properties:
                keyPairId:
                  type: string
                  description: uuid of the SSH key
      responses:
        '200':
          description: 'Array of network interfaces'
  /api/studies:
    get: 
      tags:
        - researchers
        - Studies
      summary: list studies
      operationId: listStudies
      responses:
        '200':
          description: 'Return array of studies'
    post:
      tags:
        - researchers
        - Studies
      summary: create study
      operationId: createStudy
      requestBody:
        required: true
        content:
          application/json:
            schema:
             $ref: '#/components/schemas/CreateStudy'
      responses:
        '200':
          description: 'Return the study created'
  /api/studies/{studyId}:  
    parameters:
      - name: studyId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/StudyId'
    get:
      tags:
        - researchers
        - Studies
      summary: get study
      operationId: getStudy
      responses:
        '200':
          description: 'Return the study'
    put:
      tags:
        - researchers
        - Studies
      summary: update study
      operationId: updateStudy
      requestBody:
        required: true
        content:
          application/json:
            schema:
             $ref: '#/components/schemas/UpdateStudy'
      responses:
        '200':
          description: ''
  /api/studies/{studyId}/permissions:  
    parameters:
      - name: studyId
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/StudyId'
    get:
      tags:
        - researchers
        - Studies
      summary: get study permissions
      operationId: getStudyPermissions
      responses:
        '200':
          description: 'Return study permissions'
    put:
      tags:
        - researchers
        - Studies
      summary: update study permissions
      operationId: updateStudyPermissions
      requestBody:
        required: true
        content:
          application/json:
            schema:
             $ref: '#/components/schemas/UpdateStudyPermission'
      responses:
        '200':
          description: 'Return updated study permissions'
  /api/studies/{studyId}/files:
    get:
      tags:
        - researchers
        - Studies
      summary: list study files
      operationId: listStudyFiles
      parameters:
        - name: studyId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/StudyId'
      responses:
        '200':
          description: 'Return study files'
  /api/studies/{studyId}/upload-requests:
    get: 
      tags:
        - researchers
        - Studies
      summary: create presigned upload requests
      operationId: createPresignedUploadRequests
      parameters:
        - name: studyId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/StudyId'
      responses:
        '200':
          description: 'Return presigned url for file upload'
  /api/budgets/aws-account/{awsAccountUUID}:
    parameters:
      - name: awsAccountUUID
        in: path
        required: true
        schema:
          $ref: '#/components/schemas/AwsAccountUUID'
    get:
      tags:
        - admins
        - Budgets
      summary: get budget
      operationId: getBudget
      responses:
        '200':
          description: 'Return budget of the AWS account'
    put:
      tags:
        - admins
        - Budgets
      summary: update budget
      operationId: updateBudget
      requestBody:
        required: true
        content:
          application/json:
            schema:
             $ref: '#/components/schemas/CreateBudget'
      responses:
        '200':
          description: 'Return success update message'
  /api/budgets/aws-account:  
    post:
      tags:
        - admins
        - Budgets
      summary: create budget
      operationId: createBudget
      requestBody:
        required: true
        content:
          application/json:
            schema:
             $ref: '#/components/schemas/CreateBudget'
      responses:
        '200':
          description: 'Return success create message'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    AwsAccountId:
      type: string
      pattern: ^[0-9]{12}$
    AwsAccountUUID:
      type: string
      minLength: 1
      maxLength: 100
      pattern: '^[A-Za-z0-9-_ ]+$'
    WorkspaceId:
      type: string
      minLength: 1
      maxLength: 100
      pattern: '^[A-Za-z0-9-_ ]+$'
    StudyId:
      type: string
      minLength: 1
      maxLength: 100
      pattern: '^[A-Za-z0-9-_ ]+$'
    ConnectionId:
      type: string
    AwsPartition:
      type: string
      enum:
        - aws
        - aws-cn
        - aws-us-gov
    AwsRegion:
      type: string
      enum:
          - us-west-1
          - us-west-2
          - us-east-1
          - us-east-2
          - af-south-1
          - ap-east-1
          - ap-south-1
          - ap-northeast-1
          - ap-northeast-2
          - ap-northeast-3
          - ap-southeast-1
          - ap-southeast-2
          - ca-central-1
          - cn-north-1
          - cn-northwest-1
          - eu-central-1
          - eu-north-1
          - eu-south-1
          - eu-west-1
          - eu-west-2
          - eu-west-3
          - me-south-1
          - sa-east-1
          - us-gov-east-1
          - us-gov-west-1
    CreateDataSourceAccount:
      required:
      - id
      - mainRegion
      - name
      type: object
      properties:
        name:
          maxLength: 300
          minLength: 1
          type: string
        description:
          maxLength: 2048
          type: string
        contactInfo:
          maxLength: 2048
          type: string
        id:
          $ref: '#/components/schemas/AwsAccountId'
        mainRegion:
          $ref: '#/components/schemas/AwsRegion'
    UpdateDataSourceAccount:
      type: object
      required:
      - id
      - rev
      properties:
        id:
          $ref: '#/components/schemas/AwsAccountId'
        rev:
          type: number
        name:
          type: string
          minLength: 1
          maxLength: 300
        description:
          type: string
          maxLength: 2048
        contactInfo:
          type: string
          maxLength: 2048
    RegisterDataSourceBucket:
      type: object
      additionalProperties: false
      properties:
        accountId:
          $ref: '#/components/schemas/AwsAccountId'
        name:
          type: string
          minLength: 3
          maxLength: 255
        region:
          $ref: '#/components/schemas/AwsRegion'
        awsPartition:
          $ref: '#/components/schemas/AwsPartition'
        kmsArn:
          type: string
          maxLength: 90
        access:
          type: string
          enum:
            - roles
            - accessPoint
            - bucketPolicy
        sse:
          type: string
          enum:
            - kms
            - s3
            - none
      required:
        - accountId
        - name
        - region
        - awsPartition
        - access
        - sse
    DataSourceReachability:
      type: object
      required:
        - id
      properties:
        id:
          type: string
          description: Use * for bulk reach data source account, or dsAccountId, studyId with type
        type:
          type: string
          enum:
            - dsAccount
            - study
          description: id must NOT be * when type is specified
        status:
          type: string
          description: id must be * when status is specified
    RegisterStudy:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Za-z0-9-_ ]+$'
        name:
          type: string
          maxLength: 2048
        category:
          type: string
          enum:
            - My Studies
            - Organization
        description:
          type: string
          maxLength: 8192
        projectId:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Za-z0-9-_]+$'
        folder:
          type: string
          minLength: 1
          maxLength: 1000
        kmsArn:
          type: string
          maxLength: 90
        kmsScope:
          enum:
            - bucket
            - study
            - none
        adminUsers:
          type: array
          items:
            type: string
        accessType:
          type: string
          enum:
            - readonly
            - readwrite
      required:
        - id
        - category
        - folder
        - accessType
        - adminUsers
    EnvTypeId:
      type: string
      example: 'prod-hpr4lsrmztito-pa-vg2oae2qdhmfq'
      maxLength: 100
      minLength: 2
      pattern: '^[a-zA-Z0-9_\\-]*'
    CreateEnvType:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          maxLength: 100
          minLength: 2
          pattern: '^[a-zA-Z0-9_\\-]*'
        name:
          type: string
          maxLength: 16383
          minLength: 2
          pattern: '^[a-zA-Z0-9_\\-]*'
        desc:
          type: string
          maxLength: 8191
        status:
          type: string
          enum:
            - not-approved
            - approved
        product:
          type: object
          additionalProperties: false
          properties:
            productId:
              type: string
              maxLength: 100
              pattern: '^[a-zA-Z0-9_\\-]*'
          required:
            - productId
        provisioningArtifact:
          type: object
          additionalProperties: false
          properties:
            id:
              type: string
              maxLength: 100
              pattern: '^[a-zA-Z0-9_\\-]*'
          required:
            - id
      required:
        - id
        - name
        - product
        - provisioningArtifact
    UpdateEnvType: 
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          maxLength: 100
          minLength: 2
          pattern: '^[a-zA-Z0-9_\\-]*'
        rev:
          type: number
        name:
          type: string
          maxLength: 16383
          minLength: 2
          pattern: '^[a-zA-Z0-9_\\-]*'
        desc:
          type: string
          maxLength: 8191
        status:
          type: string
          enum:
            - not-approved
            - approved
      required:
        - id
        - rev
    EnvTypeConfig:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          maxLength: 128
          minLength: 2
          pattern: '^[A-Za-z0-9-_]+$'
        name:
          type: string
          maxLength: 128
          minLength: 2
          pattern: '^[A-Za-z0-9-_ ]+$'
        desc:
          type: string
          maxLength: 8191
        estimatedCostInfo:
          type: string
          maxLength: 1024
        allowRoleIds:
          type: array
          items:
            type: string
            maxLength: 100
            pattern: '^[A-Za-z0-9-_ ]+$'
        denyRoleIds:
          type: array
          items:
            type: string
            maxLength: 100
            pattern: '^[A-Za-z0-9-_ ]+$'
        params:
          type: array
          items:
            type: object
            properties:
              key:
                type: string
              value:
                type: string
        tags:
          type: array
          items:
            type: object
            properties:
              key:
                type: string
              value:
                type: string
      required:
        - id
        - name
    CreateSCWorkspace:
      type: object
      additionalProperties: false
      properties:
        name:
          type: string
          maxLength: 128
          minLength: 3
          pattern: '^[A-Za-z][A-Za-z0-9-]+$'
        description:
          type: string
          maxLength: 2048
        envTypeId:
          type: string
          minLength: 1
          maxLength: 100
        envTypeConfigId:
          type: string
          minLength: 1
          maxLength: 300
        projectId:
          type: string
        cidr:
          type: string
          pattern: '^(?:([0-9]{1,3}\.){3}[0-9]{1,3}(\/([0-9]|[1-2][0-9]|3[0-2]))?)?$'
        studyIds:
          type: array
          items:
            type: string
            minLength: 1
      required:
        - name
        - envTypeId
        - envTypeConfigId
    CreateStudy:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Za-z0-9-_ ]+$'
        name:
          type: string
          maxLength: 2048
        category:
          type: string
          enum:
            - My Studies
            - Organization
            - Open Data
        description:
          type: string
          maxLength: 8192
        projectId:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Za-z0-9-_]+$'
        uploadLocationEnabled:
          type: boolean
        sha:
          type: string
          maxLength: 64
        resources:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              arn:
                type: string
        accessType:
          type: string
          enum:
            - readonly
            - readwrite
      required:
        - id
        - category
    UpdateStudy:
      type: object
      additionalProperties: false
      properties:
        id:
          type: string
          minLength: 1
          maxLength: 100
          pattern: '^[A-Za-z0-9-_ ]+$'
        rev:
          type: number
        name:
          type: string
          maxLength: 2048
        description:
          type: string
          maxLength: 8192
        sha:
          type: string
          maxLength: 64
        appRoleArn:
          type: string
          maxLength: 2048
        resources:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              arn:
                type: string
              fileShareArn:
                type: string
      required:
        - id
    permissionLevel:
          type: string
          enum:
            - admin
            - readonly
            - writeonly
            - readwrite
    userEntry:
      type: object
      properties:
        uid:
          type: string
        permissionLevel:
          $ref: '#/components/schemas/permissionLevel'
      required:
        - uid
    UpdateStudyPermission: 
      type: object
      additionalProperties: false
      properties:
        usersToAdd:
          type: array
          items:
            $ref: '#/components/schemas/userEntry'
        usersToRemove:
          type: array
          items:
            $ref: '#/components/schemas/userEntry'
    CreateBudget:
      type: object
      required:
        - id
        - budgetConfiguration
      properties:
        id:
          type: string
          minLength: 1
        budgetConfiguration:
          type: object
          required:
            - budgetLimit
            - startDate
            - endDate
          properties:
            budgetLimit:
              type: string
            startDate:
              type: integer
            endDate:
              type: integer
            thresholds:
              type: array
              items:
                type: number
                enum:
                  - 50
                  - 70
                  - 80
                  - 90
                  - 100
              description: thresholds and notification depend on each other
            notificationEmail:
              type: string
              format: email
              description: thresholds and notification depend on each other
          additionalProperties: false
      additionalProperties: false
security: 
  - bearerAuth: []